
<!-- DESKRIPSI -->
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<title>Pelatihan PT SSI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- BOOTSTRAP 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- BOOTSTRAP ICONS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<STYLE>
    

body {
    min-height: 100vh;
    font-family: 'Segoe UI', sans-serif;
    background: seagreen;
    color: #0f172a;
}

/* Container */
.mainbox {
    max-width: 1200px;
    margin: auto;
}

/* Card umum */
.card {
    border-radius: 18px;
    border: none;
    background: #f8fafc;
}

/* Header card */
.card-header {
    background: darkblue;
    color: white;
    font-weight: 700;
    border-radius: 18px 18px 0 0;
}

/* Box soal */
.soal-box {
    background: #ffffff;
    padding: 18px;
    border-radius: 14px;
    border: 1px solid #e5e7eb;
    margin-bottom: 18px;
}

/* Judul */
h3 {
    color: #d4af37;
}

h5 {
    color: #cbd5e1;
}

/* Overlay loading */
#loadingOverlay {
    position: fixed;
    inset: 0;
    background: rgba(15, 23, 42, 0.85);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    color: #fff;
}

/* Cursor */
.cursor-pointer {
    cursor: pointer;
}

/* Radio checked */
input[type="radio"]:checked {
    accent-color: #16a34a;
}

/* Card radio aktif */
.card:has(input[type="radio"]:checked) {
    border: 2px solid #16a34a;
    background: #ecfdf5;
}

/* Button utama */
.btn-warning {
    background: linear-gradient(135deg, #d4af37, #c9a227);
    border: none;
    color: #0f172a;
    font-weight: 700;
}

.btn-warning:hover {
    background: linear-gradient(135deg, #c9a227, #b8961e);
    color: #0f172a;
}

/* Input & select */
.form-control,
.form-select {
    border-radius: 10px;
    border: 1px solid #cbd5e1;
}

.form-control:focus,
.form-select:focus {
    border-color: #d4af37;
    box-shadow: 0 0 0 0.15rem rgba(212, 175, 55, 0.35);
}

/* Hidden */
.hidden {
    display: none;
}
</STYLE>
</head>

<body>

<!-- LOADING -->
<div id="loadingOverlay">
    <div class="text-center">
        <div class="spinner-border"></div>
        <p class="mt-3 fw-bold">Mengambil soal...</p>
    </div>
</div>

<div class="container mainbox py-5">

    <!-- JUDUL -->
    <div class="text-center mb-4">
        <h3 class="fw-bold text-white">
            <i class="bi bi-mortarboard-fill me-2"></i>
             TEST PENGETAHUAN ATM
        </h3>
        <h5 class="text-white">
            <i class="bi bi-journal-text me-1"></i>
            Untuk Calon Pegawai Baru PT SSI
        </h5>
    </div>

    <!-- FORM PESERTA -->
    <div id="formPeserta" class="card shadow-lg border-0">

        <div class="card-header bg-danger text-white fw-bold">
            <i class="bi bi-person-vcard me-2"></i>
            Data Calon Pegawai Baru 
        </div>

        <div class="card-body p-4">

            <!-- NAMA -->
            <div class="mb-3">
                <label class="form-label fw-semibold">
                    <i class="bi bi-person-fill me-1 text-success"></i>
                    Nama Calon Pegawai Baru 
                </label>
                <input id="nama" class="form-control" placeholder="Nama Pegawai">
            </div>

            <!-- Domisili  -->
            <div class="mb-3">
                <label class="form-label fw-semibold">
                    <i class="bi bi-geo-alt-fill me-1 text-success text-success"></i>
                    Kota domisili anda saat ini ?  
                </label>
                <input id="domisili" class="form-control" placeholder="masukkan kota Domisili  ">
            </div>

            <!-- PENDIDIKAN -->
            <div class="mb-3">
                <label class="form-label fw-semibold">
                    <i class="bi bi-mortarboard-fill me-1 text-success"></i>
                    pendidikan terakhir 
                </label>
                <select id="pendidikan" class="form-select">
                    <option value="">-- Pilih Pendidikan Terakhir  --</option>
                    <option>SMU/SMK </option>
                    <option>Diploma</option>
                    <option>Sarjana - S1</option>
                    <option>Sarjana - S2</option>        
                </select>
            </div>

            <!-- STATUS -->

            <div class="mb-3">
                <label class="form-label fw-semibold d-block mb-2">
                    <i class="bi bi-people-fill me-1 text-success"></i>
                    Status pernikahan ?
                </label>

                <div class="row g-2">

                    <!-- MENIKAH -->
                    <div class="col-md-4">
                        <label class="card p-3 h-100 shadow-sm cursor-pointer">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="status" value="Menikah">
                                <span class="fw-semibold ms-2">Menikah</span>
                            </div>
                        </label>
                    </div>

                    <!-- BELUM MENIKAH -->
                    <div class="col-md-4">
                        <label class="card p-3 h-100 shadow-sm cursor-pointer">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="status" value="Belum Menikah">
                                <span class="fw-semibold ms-2">Belum Menikah</span>
                            </div>
                        </label>
                    </div>

                    <!-- BERCERAI -->
                    <div class="col-md-4">
                        <label class="card p-3 h-100 shadow-sm cursor-pointer">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="status" value="Bercerai">
                                <span class="fw-semibold ms-2">Bercerai</span>
                            </div>
                        </label>
                    </div>

                </div>
            </div>


             <!-- PENGALAMAN -->
            <div class="mb-3">
                <label class="form-label fw-semibold">
                    <i class="bi bi-briefcase-fill me-1 text-success"></i>
                    Pernah bekerja di perusahaan Sejenis PT SSI ?
                </label>
                <select id="pengalaman" class="form-select">
                    <option value="">-- Pilih Opsi dibawah ini --</option>
                    <option> Pernah Bekerja di BANK  </option>
                    <option> pernah Bekerja di Perusahaan ATM  </option>
                    <option> Belum Pernah  </option>
                </select>
            </div>



            <!-- NO TELP -->
            <div class="mb-3">
                <label class="form-label fw-semibold">
                    <i class="bi bi-telephone-fill me-1 text-success"></i>
                    No HP yang bisa di hubungi ?
                </label>
                <input id="telepon" class="form-control" placeholder="isi Nomer Telp ">
            </div>

            
            <!-- BUTTON -->
            <button 
                class="btn btn-warning w-100 fw-bold py-2 shadow-sm"
                onclick="mulaiPostTest()">
                <i class="bi bi-play-circle-fill me-2"></i>
                Mulai test TKD 
            </button>

        </div>
    </div>

</div>


<!-- KUIS -->
<div id="kuisBox" class="hidden mt-4">
<div class="card shadow">
<div class="card-header">Post Test</div>
<div class="card-body">
<div id="listSoal"></div>
<button class="btn btn-primary w-100 fw-bold" onclick="kumpulkan()">Kumpulkan Jawaban</button>
</div>
</div>
</div>

<!-- HASIL -->
<div id="hasilBox" class="hidden mt-4 card shadow p-4 text-center">
<h4 id="tampilNilai"></h4>
<button id="btnCetak" class="btn btn-warning mt-3 hidden" onclick="cetakSertifikat()">Cetak Sertifikat</button>
<button id="btnUlang" class="btn btn-danger mt-3 hidden" onclick="ulangKuis()">Ulangi Post Test</button>
</div>

</div>


<script>
const WEBAPP = "https://script.google.com/macros/s/AKfycbw9aq_b9-ZKnf8HqP4S7aX0Vw1ctKbpc359084E5612Mr8PqG6hwGH4tp76dZOYrDGprQ/exec";

const formPeserta = document.getElementById("formPeserta");
const kuisBox = document.getElementById("kuisBox");
const hasilBox = document.getElementById("hasilBox");
const tampilNilai = document.getElementById("tampilNilai");
const listSoal = document.getElementById("listSoal");
const loadingOverlay = document.getElementById("loadingOverlay");

let DATA_SOAL = [];
let USER = {};
let SUDAH_KIRIM = false; // ⛔ anti double submit

async function mulaiPostTest(){

    const statusRadio = document.querySelector('input[name="status"]:checked');
    USER.status = statusRadio ? statusRadio.value : "";

    USER.nama = nama.value.trim();
    USER.domisili = domisili.value.trim();
    USER.pendidikan = pendidikan.value;   
    USER.pengalaman = pengalaman.value;
    USER.telepon = telepon.value.trim();

    if(!USER.nama || !USER.telepon){
        alert("Nama & nomor telepon wajib diisi!");
        return;
    }

    formPeserta.classList.add("hidden");
    loadingOverlay.style.display="flex";

    const res = await fetch(WEBAPP+"?action=getsoal");
    DATA_SOAL = await res.json();

    let html="";
    DATA_SOAL.forEach((s,i)=>{
        html+=`
        <div class="soal-box">
            <b>${i+1}. ${s.soal}</b><br><br>
            ${["A","B","C","D"].map(p=>`
                <label class="d-block">
                    <input type="radio" name="soal${i}" value="${p}">
                    ${p}. ${s["opsi"+p]}
                </label>
            `).join("")}
        </div>`;
    });

    listSoal.innerHTML = html;
    loadingOverlay.style.display="none";
    kuisBox.classList.remove("hidden");
}

async function kumpulkan(){
    if (SUDAH_KIRIM) return; // ⛔ cegah submit ulang
    SUDAH_KIRIM = true;

    let benar = 0;
    DATA_SOAL.forEach((s,i)=>{
        const j = document.querySelector(`input[name=soal${i}]:checked`);
        if(j && j.value === s.kunci) benar++;
    });

    USER.nilai = Math.round((benar / DATA_SOAL.length) * 100);

    await fetch(WEBAPP+"?action=simpannilai", {
        method: "POST",
        body: JSON.stringify(USER)
    });

    kuisBox.classList.add("hidden");
    hasilBox.classList.remove("hidden");
    tampilNilai.innerHTML = `Nilai Anda: <b>${USER.nilai}</b>`;
}
</script>

</body>
</html>
