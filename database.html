<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Database Pelamar</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
body{background:#f4f6fb}
.card{border-radius:14px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
</style>
</head>

<body>
<div class="container py-5">

<h4 class="fw-bold text-primary mb-3">
  <i class="bi bi-database-fill"></i> Database Pelamar
</h4>

<div class="card">
<div class="card-body">

<!-- HEADER ATAS TABEL -->
<div class="d-flex justify-content-end mb-3">
  <a href="https://docs.google.com/spreadsheets/d/1JryGMgd6Vp4bFXjzc48siqgn0ufEA-6KDTQVzuT5Q6Q/edit?usp=sharing" target="_blank"
     class="btn btn-success btn-sm fw-semibold">
    <i class="bi bi-google"></i> Klik Database Spreadsheet
  </a>
</div>

<table class="table table-bordered align-middle">
<thead class="table-primary text-center">
<tr>
<th>Timestamp</th>
<th>Nama</th>
<th>Domisili</th>
<th>Telp</th>
<th>Usia</th>
<th>Pendidikan</th>
<th>Jurusan</th>
</tr>
</thead>

<tbody id="tbody">
<tr>
  <td colspan="7" class="text-center text-muted">Loading...</td>
</tr>
</tbody>
</table>

<!-- PAGINATION -->
<div class="d-flex justify-content-between align-items-center">
<button class="btn btn-outline-primary btn-sm" onclick="prevPage()">← Prev</button>
<span id="pageInfo" class="fw-semibold"></span>
<button class="btn btn-outline-primary btn-sm" onclick="nextPage()">Next →</button>
</div>

</div>
</div>

</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbzvijXzjvBYX9UED5ufPR5up9LEyesf_Rd3VgFUwNB1N1DqPGRHnMx1r74n3fF6eDNX/exec";

let page  = 1;
let limit = 20;
let total = 0;

function loadData(){
  fetch(`${API}?page=${page}&limit=${limit}`)
    .then(res=>res.json())
    .then(res=>{
      total = res.total;
      renderTable(res.data);
      renderInfo();
    });
}

function renderTable(data){
  const tbody = document.getElementById("tbody");
  if(!data.length){
    tbody.innerHTML = `
      <tr>
        <td colspan="7" class="text-center text-muted">Tidak ada data</td>
      </tr>`;
    return;
  }

  tbody.innerHTML = data.map(r=>`
    <tr>
      <td>${r.Timestamp}</td>
      <td class="fw-semibold">${r.nama}</td>
      <td>${r.domisili}</td>
      <td>${r.telp}</td>
      <td class="text-center">${r.usia} th</td>
      <td class="text-center">${r.pendidikan}</td>
      <td>${r.Jurusan}</td>
    </tr>
  `).join("");
}

function renderInfo(){
  const maxPage = Math.ceil(total / limit);
  document.getElementById("pageInfo").innerText =
    `Page ${page} / ${maxPage} • Total ${total} data`;
}

function nextPage(){
  if(page * limit < total){
    page++;
    loadData();
  }
}

function prevPage(){
  if(page > 1){
    page--;
    loadData();
  }
}

loadData();
</script>

</body>
</html>
